
<script>
let uniqueRandomNums = [];    // Array Of existed random numbers
var txtFileData = ["Philadelphia - Pennsylvania (PA) - 1,553,165", "Memphis - Tennessee (TN) - 653,450", "Kansas City - Missouri (MO) - 467,007", "Paramount - California (CA) - 54,980", "Elizabeth - New Jersey (NJ) - 127,558", "New York - New York (NY) - 8,405,837", "San Francisco - California (CA) - 837,442", "Greenville - North Carolina (NC) - 89,130", "Washington - District of Columbia - 646,449", "Vancouver - Washington (WA) - 167,405"];
let populationData = [];      // Array for sorting city population vise

function generateRandomCities() {
   let randomNo = document.getElementById("inputRandomNumber").value;
   let code = "";
   uniqueRandomNums = [];     // Re-initialize array of existed random numbers
   txtFileData = [];
   let indexData = 0;
   populationData = [];
   let poIndex = 0;

   // Generate Cards
   for (i = 1; i <= randomNo; i++) {
      if (i <= arrayOfDetails.length) {
         let random = getRandomNoCities(arrayOfDetails.length);    // Generate Random Number

         // Create TXT File Of Cities
         txtFileData[indexData++] = arrayOfDetails[random]["city"] + ' - ' + arrayOfDetails[random]["state"] + ' - ' + Intl.NumberFormat('en-US').format(arrayOfDetails[random]["population"]);

         // Create array for sort city by population
         populationData[poIndex++] = arrayOfDetails[random];

         code += '<div class="column is-narrow"><div class="card has-background-light has-text-centered customize-card"><div class="card-content"><span class="city-text">' + arrayOfDetails[random]["city"] + '</span></div><footer class="card-footer"><p class="card-footer-item title is-size-6" title="State of the ' + arrayOfDetails[random]["city"] + ' City">' + arrayOfDetails[random]["state"] + '</p></footer><footer class="card-footer"><p class="card-footer-item title is-size-6 has-text-grey" title="Population of the ' + arrayOfDetails[random]["city"] + ' City">' + Intl.NumberFormat('en-US').format(arrayOfDetails[random]["population"]) + '</p></footer></div></div>';
         document.getElementById("generatedCities").innerHTML = i;
      }
   }

   document.getElementById("citySectionArea").innerHTML = code;
   sortPopulation();
}


// Show/Hide city name functionality for Random City Generator
function sortPopulation() {
   if (document.getElementById('isSortPopulation').checked) {
      let sortedCode = "";
      let sortedArray = populationData.sort((a, b) => parseInt(b.population) - parseInt(a.population));

      for (i = 0; i < sortedArray.length; i++) {
         sortedCode += '<div class="column is-narrow"><div class="card has-background-light has-text-centered customize-card"><div class="card-content"><span class="city-text">' + sortedArray[i]["city"] + '</span></div><footer class="card-footer"><p class="card-footer-item title is-size-6" title="State of the ' + sortedArray[i]["city"] + ' City">' + sortedArray[i]["state"] + '</p></footer><footer class="card-footer"><p class="card-footer-item title is-size-6 has-text-grey" title="Population of the ' + sortedArray[i]["city"] + ' City">' + Intl.NumberFormat('en-US').format(sortedArray[i]["population"]) + '</p></footer></div></div>';
      }
      document.getElementById("citySectionArea").innerHTML = sortedCode;
   }
}

function getRandomNoCities(totalCodes) {
   //Generate random number
   let random = Math.floor(Math.random() * totalCodes);
   random = Number(random);

   // Check random number is repats or not
   if (!uniqueRandomNums.includes(random)) {
      uniqueRandomNums.push(random);
      return random;

   }
   else {
      if (uniqueRandomNums.length < totalCodes) {
         //Recursively generate number
         return getRandomNoCities(totalCodes);
      }
   }
}

function getCities(number) {
   if (arrayOfDetails == null) {
      getDataFromServer(number);
      return;
   }

   if (number == "random") {
      number = Math.floor(Math.random() * arrayOfDetails.length);

   } else if (number == "all") {
      number = arrayOfDetails.length;

   } else if (number == null || number == 0) {
      number = document.getElementById("inputRandomNumber").value;
   }
   document.getElementById("inputRandomNumber").value = number;

   if (arrayOfDetails != null) {
      generateRandomCities();
   }
}

</script>